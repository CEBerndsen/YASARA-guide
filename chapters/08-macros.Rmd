# Macros

Throughout this guide, the command line using syntax such as `ColorRes` and `PosOriObj` has been useful for doing manipulations to the structures and scenes in YASARA. However, typing many commands repeatedly can be tedious and potentially irreproducible. Static images are great illustrations of simple points, however sometimes an idea is too complex or a single image OR an interactive movie might be a more useful display item. This is where macros can come in. A **macro** is a file that contains all the commands as you would type them into the command line that is read by YASARA as a series of instructions for how to show, analyze, and/or record data. This chapter will focus on macros for making movies such as those shown HERE, while Chapter 9 will focus on macros for analysis.

## Text editors

Making a macro for YASARA requires a text editor such as ![NotePad](https://en.wikipedia.org/wiki/Microsoft_Notepad), ![WordPad](https://en.wikipedia.org/wiki/WordPad), or ![TextEdit](https://support.apple.com/guide/textedit/welcome/mac). Each command is listed on a separate line and the entire file saved as a .mcr file type.  See \@ref(macrosave) and \@ref(macrotext) for more information about saving YASARA appropriate macro files. 

## Organization of a macro {#macro}

Macros, regardless of function, all share a common header like that shown in Figure \@ref(fig:header). The header is not shown or seen, unless the macro file is opened directly, but it can provide useful information to the reader such as the purpose and author of the macro.

```{r header, echo=FALSE, warning=FALSE, message=FALSE, out.width="120%", fig.cap="Macro header in YASARA"}

knitr::include_graphics("images/mcrheader.PNG")

```

### The `#` as a way to help your reader (and you!)

A list of YASARA commands, such as is shown below, can be dense to read and interpret.

```{r dense, echo=TRUE, warning=FALSE, message=FALSE, eval=FALSE}
>LoadPDB 1crn, download=yes
>AutoPosOriObj 1, x = 1, y = 10, z = 0, alpha = 0, beta = 0, gamma = 0
>ColorRes cys, green
>ShowRes cys
>BallStickRes cys
>AutoRotateObj 1, Y = 1
>wait 180
>AutoRotateObj 1, Y = 0
>ZoomRes Cys 16, step = 50
>wait 100
>ZoomRes all

```

Just reading this list of commands and finding the one you need is difficult. Any line that starts with `#` however will not be read by YASARA and can serve to help reduce the density of text and is good for writing notes to your future self as shown below.

```{r sparse, echo=TRUE, warning=FALSE, message=FALSE, eval=FALSE}
# Load the structure of crambin from the internet
>LoadPDB 1crn, download=yes

# Position and orient the object as below to better show the over structure
>AutoPosOriObj 1, x = 1, y = 10, z = 0, alpha = 0, beta = 0, gamma = 0

#Color the cysteine residues green and show them as ball-stick forms
>ColorRes cys, green
>ShowRes cys
>BallStickRes cys

# Rotate the object, wait for 180 degrees, then stop
>AutoRotateObj 1, Y = 1
>wait 180
>AutoRotateObj 1, Y = 0

# Zoom in on cysteine 16 over the course of 50 steps, wait for 100 screen refreshes, then zoom out
>ZoomRes Cys 16, step = 50
>wait 100
>ZoomRes all, step = 50

```

Reading the annotated commands above, it is clearer what is intended and how the code leads to this result. Use `#` as a note to your future self so that if you need to re-use code or want to troubleshoot, you can find your target easier.

## Making a macro

To make a macro, open your text editor then make your header followed by your commands. HERE is a general template that can be derived as needed. The first set of commands are shown in the code box below and they set the environment. These settings can be adjusted as needed (use `SearchDoc` for more details) but are good places to start for most computers.

```{r macrot, echo=TRUE, warning=FALSE, message=FALSE, eval=FALSE}

# Change working directory to the place of this macro
# (so that we don't have to specify paths when loading stuff).
CD (MacroDir)

#If there is an error, the macro continues
OnError Continue

# Don't show console and head up display
Console Off
HUD Off

# Set default parameters
CoordSys Left
Projection perspective
StickRadius 50
BallStickRadius 50,50
AtomTexture 1
Fog 70
ColorFog Black
SurfPar Resolution=3, Molecular=Gaussian
AtomSize 100

# Animation delay
delay=400

# Set the YASARA window size
ScreenSize X=1024,Y=768,Scale=1

```

### Commands that can be used in a macro

After the header and the environment settings, the YASARA commands can then be typed with one command per line. For most macros that are simply displaying structures, the commands like `Color` (\@ref(colors)), `PosOri` (\@ref(orient)), and `Label` (\@ref(labels)) along with broader sets of commands for changing display style (\@ref(style)) and surfaces (\@ref(surfaces)) work just as they would be typed into the command line. However there are additional commands that can be useful as well. 

#### Rotate {#rotate}

